<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="../styles.css">
    <link rel="icon" href="/images/film-frames.ico">
    <link href="https://fonts.cdnfonts.com/css/menlo" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body style="font-family:Menlo">
    <title>Clusk.net | Twitter Reach Checker</title>

    <!-- navbar-->
    <a href="index.html"><img src="images/Home.png"></a>
    <a href="links.html"><img src="images/Links.png"></a>

    <!-- gallery -->
    <div class="gallery">
        <h2>Local Reach</h2>
        <p>The term I use to describe the sum of any Twitter user's follower's followers.</p>
        <p>It is a useful metric in evaluating follower quality.</p>
        <h3>Check local reach:</h3>
        <form>
            <input type="text" name="handle" placeholder="Enter a Twitter handle">
            <input type="submit" value="Check" onClick="submitHandle(this.form)">
        </form>
    </div>
    <p style="color:red">_______________________</p>
    <p>A personal site for clusk <a href="https://twitter.com/twocitizenships">[@twocitizenships]</a></p>
    <script type="module">
        const twitterApi = require("twitter-api-sdk");
        import { Client } from "twitter-api-sdk";
        const client = new twitterApi.Client(process.env.BEARER_TOKEN)

        function submitHandle(form) {
            form.preventDefault();
            form.handle.value = "";
            console.log(form.handle.value)
            var handle = form.handle.value;
            var localReach;

            //Call Twitter API to get user's follower count
            var user = client.users.show({ screen_name: handle })
            var followers = user.followers_count;
            console.log(followers)
            //Loop through user's followers and add their follower count to localReach
            var followersList = client.users.followers({ screen_name: handle })
            for (var i = 0; i < followersList.length; i++) {
                localReach += followersList[i].followers_count;
                console.log(localReach)
            }
            //Display local reach
            const localReachDiv = document.createElement("div");
            const localReachValue = document.createTextNode(localReach);
            localReachDiv.appendChild(localReachValue)
        }
    </script>

    <script src="https://code.jquery.com/jquery-3.6.3.min.js"
        integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
</body>

</html>